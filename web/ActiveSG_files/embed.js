var Embed=Embed||{};Embed.Bootstrapper=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){$(document).one("spectrum-load",function(){Embed.SpectrumAnalytics=new Spectrum.Analytics;var e=$("#embed-body").data("spectrum-base-url").toString()+"/v1/signals/embed/view";Embed.SpectrumAnalytics.log({url:e})}),$(window).one("mouseover",function(){Embed.DeferredScripts().load()}),$("#embed-body img.assetcomp").on("load",function(){Embed.CompatibilityManager().init(),Embed.AttributionLayout().init(),Embed.CaptionLayout().init(),Embed.SocialMenu().init(),$("#embed-body img.assetcomp").addClass("ready")}).each(function(){this.complete&&$(this).load()}),$(window).resize(function(){Embed.RadialMenu().hide(),Embed.AttributionLayout().init(),Embed.CaptionLayout().init(),Embed.SocialMenu().hide(),Embed.SocialMenu().init()}),$("#radial-menu").on("contextmenu",function(e){return Embed.Event().absorb(e)}).on("mousedown",function(e){return 2===e.button?Embed.Event().absorb(e):!0}),$("#embed-body .icon-social").bind("click",function(e){return Embed.SocialMenu().toggle(),Embed.Event().absorb(e)}),$("#assetcomp-overlay").on("contextmenu",function(e){return Embed.MediaQuery().mobile()?!0:Embed.Event().absorb(e)}).on("mousedown",function(e){return 2!==e.button||Embed.MediaQuery().mobile()?!0:Embed.Event().absorb(e)}).on("mouseup",function(e){return 2!==e.button||Embed.MediaQuery().mobile()?!0:Embed.Event().absorb(e)}).on("touchstart",function(e){Embed.TouchHandler().touchstart(e),Embed.Event().stopPropagation(e)}).on("touchmove",function(e){Embed.TouchHandler().touchmove(e),Embed.Event().stopPropagation(e)}).on("touchend",function(e){Embed.TouchHandler().touchend(e),Embed.Event().stopPropagation(e)})};return{init:e}},Embed.TouchState={x:0,y:0,moving:!1,href:null,timeouts:[],set:function(e,t){var n=Embed.TouchHandler().touches(e)[0];this.href=t,this.x=n.pageX,this.y=n.pageY,this.moving=!1}},Embed.TouchTimerState={startTime:0,endTime:0},Embed.TouchTimer=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=250,t=function(t){Embed.TouchTimerState.startTime=Date.now(),Embed.TouchState.timeouts.push(window.setTimeout(function(){Embed.TouchHandler().touchend(t),Embed.Event().stopPropagation(t)},e))},n=function(){Embed.Timeouts().clear(Embed.TouchState.timeouts),Embed.TouchTimerState.endTime=Date.now()},i=function(){return Embed.TouchTimerState.endTime-Embed.TouchTimerState.startTime>=e};return{start:t,stop:n,hold:i}},Embed.TouchHandler=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e){return e&&!e.touches&&e.originalEvent&&e.originalEvent.touches?e.originalEvent.touches:e&&e.touches?e.touches:["error"]},t=function(t){var n=$("#embed-body figure.assetcomp a");return e(t).length>1?(Embed.TouchTimer().stop(),!1):(Embed.TouchState.set(t,n.attr("href")),Embed.TouchTimer().start(t),!0)},n=function(t){var n=e(t)[0],i=10;(n.pageY>Embed.TouchState.y+i||n.pageY<Embed.TouchState.y-i||n.pageX>Embed.TouchState.x+i||n.pageX<Embed.TouchState.x-i)&&(Embed.TouchState.moving=!0)},i=function(e){var t=Embed.SocialMenu();return Embed.TouchTimer().stop(),Embed.CaptionLayout().visible()&&!Embed.TouchState.moving?(Embed.CaptionLayout().hide(),Embed.Event().preventDefault(e),!1):t.visible()&&!Embed.TouchState.moving?(t.hide(),Embed.Event().preventDefault(e),!1):(Embed.TouchTimer().hold()&&!Embed.TouchState.moving?Embed.RadialMenu().show(e):Embed.TouchTimer().hold()||Embed.TouchState.moving||!Embed.RadialMenu().visible()?Embed.TouchTimer().hold()||Embed.TouchState.moving||Embed.RadialMenu().visible()||(window.open(Embed.TouchState.href,"_blank"),Embed.ClickHandler().click("ADP")):Embed.RadialMenu().hide(),!0)};return{touchstart:t,touchmove:n,touchend:i,touches:e}},Embed.PreviewBootstrapper=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){$("#embed-body img.assetcomp").on("load",function(){Embed.AttributionLayout().init(),Embed.CaptionLayout().init()}).each(function(){this.complete&&$(this).load()}),$(window).resize(function(){Embed.AttributionLayout().init(),Embed.CaptionLayout().init()}),$("img.assetcomp").bind("contextmenu",function(e){return Embed.Event().absorb(e)}),$("img.assetcomp").bind("mousedown",function(e){return 2===e.button?Embed.Event().absorb(e):!0})};return{init:e}},Embed.RadialMenu=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=$("#radial-menu"),t={x:0,y:0},n=parseInt($("#radial-menu").css("border-radius")),i=$("#radial-item-share").width(),o=function(t){d(t),r(),e.show()},a=function(){e.hide()},r=function(){var e,t,o=[$("#radial-item-share")],a=240,r=30;for(location.search.getQueryValue("caption")&&o.push($("#radial-item-info")),t=0;t<o.length;t+=1)e=(a+t*r)*(Math.PI/180),o[t].css("left",Math.round(n*Math.cos(e))+n-.5*i),o[t].css("top",Math.round(n*Math.sin(e))+n-.5*i)},d=function(o){var a,r;o.originalEvent&&o.originalEvent.touches?(t.x=o.originalEvent.touches[0].pageX,t.y=o.originalEvent.touches[0].pageY):(t.x=o.pageX,t.y=o.pageY),a=-1*n+.5*i,r=-1*n-.25*i,t.x+=r,t.y+=a,t.x>$(window).width()-1.75*n?t.x=$(window).width()-1.75*n:t.x<-.25*n&&(t.x=-.25*n),t.y<.5*i&&(t.y=.5*i),e.css("left",t.x),e.css("top",t.y)},u=function(){return e.is(":visible")&&e.css("opacity")>0};return{show:o,hide:a,visible:u}},Embed.SocialMenuState={timeouts:[]},Embed.SocialMenu=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){var e=$("#embed-body .reblog"),t=$("#embed-body .reblog li").length,n=32,i=4;t*(n+i)>$(window).width()&&(e.height(2*n),e.width(Math.ceil(t/2)*(n+i))),Embed.MediaQuery().mobile()&&e.height(e.height()+i)},t=function(){Embed.RadialMenu().hide(),Embed.MediaQuery().mobile()&&$("#embed-body .reblog").show()},n=function(){Embed.MediaQuery().mobile()&&$("#embed-body .reblog").hide()},i=function(){return $("#embed-body .reblog").is(":visible")&&$("#embed-body .reblog").css("opacity")>0};return{hide:n,init:e,show:t,visible:i}},Embed.Social=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e,t){var n=e.indexOf("?")>-1?"&":"?";return e+n+"share=embed_"+t},t=function(e,t){var n,i,o,a=/iframe.*?src%3D%22(.*?)%22/gim,r=a.exec(e);return!r||r.length<2?e:(n=r[1],i=n.indexOf("%3F")>-1?"%26":"%3F",o=n+i+"share%3Dembed_"+t,e.replace(n,o))},n=function(t){return Embed.SocialMenu().hide(),Embed.ClickHandler().click("Facebook"),FB.ui({display:"popup",method:"feed",link:e(t,"facebook")},function(){}),!1},i=function(t){return Embed.SocialMenu().hide(),Embed.ClickHandler().click("LinkedIn"),window.open(e(t,"linkedin"),"linkedin-window","width=480,height=480,resizable,scrollbars=yes"),!1},o=function(e){return Embed.SocialMenu().hide(),Embed.ClickHandler().click("Photos.com"),window.open(e,"photos-com-window"),!1},a=function(e){return Embed.SocialMenu().hide(),Embed.ClickHandler().click("Tumblr"),window.open("//www.tumblr.com/share/video?embed="+t(e,"tumblr"),"tumblr-window","width=480,height=480,resizable,scrollbars=yes"),!1},r=function(t,n){var i,o,a;return Embed.TouchState.socialDisabled||(Embed.SocialMenu().hide(),Embed.ClickHandler().click("Twitter"),i=n,o=102,i.length>o&&(a=i.length-o,i=i.substring(0,n.length-a-3),i+="..."),window.open("//twitter.com/share?url="+e(t,"twitter")+"&text="+i+"%20%7c%20Getty Images&","twitter-window","width=400,height=244,resizable,scrollbars=yes")),!1};return{facebook:n,linkedin:i,photoscom:o,tumblr:a,twitter:r}},Embed.ClickHandler=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e){var o=t(e);n(o),i(o)},t=function(e){return{asset_id:$("#embed-body").data("asset-id").toString(),click_destination:e,collection_id:$("#embed-body").data("collection-id").toString(),embed_tag:location.search.getQueryValue("et"),host:document.referrer.getHost(),is_mobile:Embed.MediaQuery().mobile(),referer:document.referrer,user_agent:navigator.userAgent}},n=function(e){var t=e.is_mobile?"-mobile":"",n="EmbedTag="+encodeURIComponent(e.embed_tag)+"&AssetId="+encodeURIComponent(e.asset_id)+"&CollectionId="+encodeURIComponent(e.collection_id)+"&Domain="+encodeURIComponent(e.host)+"&PageUrl="+encodeURIComponent(e.referer)+"&UserAgent="+encodeURIComponent(e.user_agent)+"&ClickTarget="+encodeURIComponent(e.click_destination+t);Embed.Ajax().post("/click?"+n,null,null,null)},i=function(e){var t=$("#embed-body").data("spectrum-base-url").toString()+"/v1/signals/embed/click",n=new Spectrum.Analytics;n.log({url:t,data:e})};return{click:e}},Embed.OriginalCaption={text:null},Embed.CaptionLayout=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){var e=$("#embed-body figure.assetcomp figcaption"),n=$("footer .meta").height();e.length>0&&(Embed.MediaQuery().mobile()||(n+=$("footer .reblog").height()),e.css("bottom",n),t())},t=function(){var e,t,n=12,i=$("#embed-body figcaption"),o=!1,a=8230;if(Embed.OriginalCaption.text||(Embed.OriginalCaption.text=i.text()),i.text(Embed.OriginalCaption.text),t=$(window).height()/2-n,Embed.MediaQuery().mobile()||(t-=parseInt($(".reblog").height())),i.css("max-height",t),i.outerHeight()<t&&Embed.Attribute().title($("#embed-body figure.assetcomp"),!1),48>t)i.text(""),i.hide(),Embed.Attribute().title($("#embed-body figure.assetcomp"),!0,Embed.OriginalCaption.text);else{for(Embed.Attribute().title($("#embed-body figure.assetcomp"),!1);i.outerHeight()>t;)e=i.text().replace(/\W*\s(\S)*$/,String.fromCharCode(a)),i.text(e),o=!0;o&&Embed.Attribute().title($("#embed-body figure.assetcomp"),!0,Embed.OriginalCaption.text)}},n=function(){var t=$("#embed-body figure.assetcomp figcaption");t.css("opacity",1),t.show(),Embed.RadialMenu().hide(),Embed.SocialMenu().hide(),e()},i=function(){var e=$("#embed-body figure.assetcomp figcaption");e.css("opacity",0),e.hide()},o=function(){return $("#embed-body figure.assetcomp figcaption").is(":visible")&&$("#embed-body figure.assetcomp figcaption").css("opacity")>0};return{init:e,show:n,hide:i,visible:o}},Embed.OriginalAttribution={photographer:null,collection:null},Embed.AttributionLayout=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=$("#embed-body .meta p.attribution"),t=$(".logo-container"),n=$(window),i="tight",o="line-break",a="field",r=function(){var i=32;$(e.find("span")[0]).width()+$(e.find("span")[1]).width()+t.width()+i>n.width()?$("#embed-body footer").addClass(o):$(e.find("span")[0]).width()+$(e.find("span")[1]).width()+t.width()+i<n.width()&&$("#embed-body footer").removeClass(o),$("#embed-body .logo-container").height($("#embed-body figure .gi-icon").height())},d=function(n){var o=n.data(a);t.removeClass(i),e.removeClass(i),o&&(Embed.OriginalAttribution[o]?n.text(Embed.OriginalAttribution[o]):Embed.OriginalAttribution[o]=n.text())},u=function(e){var n,i,o=-2,r=!1,d=8230;for(Embed.Attribute().title(e,!1);e.width()+t.width()+o>$(window).width();)n=e.text().split(""),n.pop(),e.text(n.join("")),r=!0;r&&(i=e.data(a),i&&Embed.Attribute().title(e,!0,Embed.OriginalAttribution[i]),e.text(e.text()+String.fromCharCode(d)))},c=function(){var o=20,a=t.find("img");t.hide(),e.width()+t.width()+o>n.width()?(t.addClass(i),e.addClass(i)):60===a.width()&&(t.removeClass(i),e.removeClass(i)),t.show()},m=function(){var t,i;0!==n.width()&&(e.addClass("transparent"),t=$(e.find("span")[0]),i=$(e.find("span")[1]),d(t),d(i),r(),c(),u(t),u(i),e.removeClass("transparent"))};return{init:m}},Embed.Attribute=function(){var e=function(e,t,n){var i="title";t?e.attr(i,n):e.removeAttr(i)};return{title:e}},Embed.CompatibilityManagerState={initialized:!1,version:null},Embed.CompatibilityManager=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){$("#embed-body figure.assetcomp").height($("#embed-body figure.assetcomp img.assetcomp").height()),$("#embed-body footer").addClass("version1")},t=function(){if(Embed.CompatibilityManagerState.version)return Embed.CompatibilityManagerState.version;var e=$("#embed-body img.assetcomp"),t=1,n=$(window),i=n.height(),o=n.width(),a=$("#body-wrapper").data("frame-width"),r=parseInt(e.attr("height"));return(a>o||o>a)&&(t=o/a),Embed.CompatibilityManagerState.version=window.top!==window.self&&Math.abs(i-r*t)>2&&i!==r?1:2,Embed.CompatibilityManagerState.version},n=function(){1===t()&&e(),Embed.CompatibilityManagerState.initialized=!0};return{init:n,v1:function(){return 1===t()}}},Embed.Ajax=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e,t,n){$.ajax(e,{async:!0,cache:!1,contentType:"application/json; utf-8",success:t?t:function(){},error:n?n:function(){}})},t=function(e,t,n,i){$.ajax(e,{async:!0,cache:!1,type:"POST",contentType:"application/json; utf-8",dataType:"json",data:JSON.stringify(t),success:n?n:function(){},error:i?i:function(){}})};return{get:e,post:t}},Embed.MediaQuery=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(){return window.matchMedia("only screen and (min-device-width : 0px) and (max-device-width : 1023px)").matches};return{mobile:e}},Embed.Event=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e){var i=t(e);return n(i)},t=function(e){var t=e||window.event;return t&&(Embed.isFunction(t.stopPropagation)&&t.stopPropagation(),t.cancelBubble=!0),t},n=function(e){var t=e||window.event;return t&&(Embed.isFunction(t.preventDefault)&&t.preventDefault(),t.returnValue=!1),!1};return{absorb:e,stopPropagation:t,preventDefault:n}},Embed.Timeouts=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e=function(e){var t,n;for(n=e.length,t=0;n>t;t+=1)window.clearTimeout(e[t]);e.length=0};return{clear:e}},Embed.isFunction=function(e){var t={};return e&&"[object Function]"===t.toString.call(e)},Embed.DeferredScripts=function(){if(!(this instanceof arguments.callee))return new arguments.callee;var e,t=function(t,n){var i;document.getElementById(t)||(i=document.createElement("script"),i.id=t,i.async=!0,i.src=n,e||(e=document.getElementsByTagName("script")[0]),e.parentNode.insertBefore(i,e))},n=function(){t("facebook-jssdk","//connect.facebook.net/en_US/all.js"),t("tumblr-jssdk","//platform.tumblr.com/v1/share.js")};return{load:n}},window.fbAsyncInit=function(){FB.init({appId:284407575061190,status:!0,cookie:!0,xfbml:!0,oauth:!0})},String.prototype.getQueryValue=function(e){var t,n,i=decodeURIComponent(this.replace("?","")),o=i.split("&");for(t=0;t<o.length;t+=1)if(n=o[t].split("="),n.length>1&&n[0]===e)return n[1];return""},String.prototype.getHost=function(){var e=document.createElement("a");return e.href=this,e.hostname};